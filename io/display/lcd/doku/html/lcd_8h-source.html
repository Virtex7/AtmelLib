<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>HD44780 Library: lcd.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>lcd.h</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *    Filename: lcd.h</span>
<a name="l00003"></a>00003 <span class="comment"> *     Version: 0.2.2</span>
<a name="l00004"></a>00004 <span class="comment"> * Description: HD44780 Display Library for ATMEL AVR</span>
<a name="l00005"></a>00005 <span class="comment"> *     License: Public Domain</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> *      Author: Copyright (C) Max Gaukler &lt;development@maxgaukler.de&gt;</span>
<a name="l00008"></a>00008 <span class="comment"> *        Date: 2010</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * I, the copyright holder of this work, hereby release it into the public domain. This applies worldwide.</span>
<a name="l00011"></a>00011 <span class="comment"> * In case this is not legally possible:</span>
<a name="l00012"></a>00012 <span class="comment"> * I grant anyone the right to use this work for any purpose, without any conditions, unless such conditions are required by law.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> */</span>
<a name="l00015"></a>00015 <span class="comment">// Until a good way is found, you have to include lcd.c, not lcd.h</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &lt;avr/pgmspace.h&gt;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &lt;avr/io.h&gt;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &lt;util/delay.h&gt;</span>
<a name="l00019"></a>00019  
<a name="l00020"></a>00020 <span class="preprocessor">#ifndef _LCD_H_INCLUDED</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span><span class="preprocessor">#define _LCD_H_INCLUDED</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span>
<a name="l00023"></a>00023 <span class="comment">// IO Helper macros</span>
<a name="l00024"></a>00024 <span class="preprocessor">#ifndef cbi</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span><span class="preprocessor">#define cbi(sfr, bit)   (sfr &amp;= ~_BV(bit))</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span>
<a name="l00028"></a>00028 <span class="preprocessor">#ifndef sbi</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="preprocessor">#define sbi(sfr, bit)   (sfr |= _BV(bit))</span>
<a name="l00030"></a>00030 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span>
<a name="l00032"></a>00032 <span class="comment"></span>
<a name="l00033"></a>00033 <span class="comment">/** \mainpage HD44780 Display Library for Atmel AVR Microcontrollers</span>
<a name="l00034"></a>00034 <span class="comment"></span>
<a name="l00035"></a>00035 <span class="comment">\section including-into-prog Including the library into your program</span>
<a name="l00036"></a>00036 <span class="comment"></span>
<a name="l00037"></a>00037 <span class="comment">Just include the file lcd.c (not .h!) into your main program.</span>
<a name="l00038"></a>00038 <span class="comment">@code #include "./lcd/lcd.c" @endcode</span>
<a name="l00039"></a>00039 <span class="comment"></span>
<a name="l00040"></a>00040 <span class="comment">\section features Features</span>
<a name="l00041"></a>00041 <span class="comment"></span>
<a name="l00042"></a>00042 <span class="comment">As long as the interrupt does not change the port that the display is connected to, the library should be interrupt-safe.</span>
<a name="l00043"></a>00043 <span class="comment"></span>
<a name="l00044"></a>00044 <span class="comment">\section interfacing Interfacing the Display to the Microcontroller</span>
<a name="l00045"></a>00045 <span class="comment">\subsection direct_4bit Direct Interfacing in 4-bit mode</span>
<a name="l00046"></a>00046 <span class="comment"> </span>
<a name="l00047"></a>00047 <span class="comment"> In 4-bit mode, 6 IO pins are needed. Data lines D4-D7, E and RS are connected to the microcontroller. RW can be directly connected to ground. If you already connected RW to the microcontroller, define LCD_RW_PIN and it will automatically be set to low. D0-D3 can be left unconnected. 4-bit-mode needs only about 1 microsecond longer per command than 8-bit-mode, but 8-bit-mode needs four more IO pins.</span>
<a name="l00048"></a>00048 <span class="comment"></span>
<a name="l00049"></a>00049 <span class="comment">This mode is selected by defining LCD_MODE_4BIT. LCD_PORT, LCD_DDR, LCD_EN_PIN, LCD_RS_PIN and LCD_D4_PIN need to be defined. D4,D5,D6,D7 are connected to LCD_D4_PIN, LCD_D4_PIN+1, and so on.</span>
<a name="l00050"></a>00050 <span class="comment"></span>
<a name="l00051"></a>00051 <span class="comment">Example:</span>
<a name="l00052"></a>00052 <span class="comment">@code</span>
<a name="l00053"></a>00053 <span class="comment">#define LCD_MODE_4BIT</span>
<a name="l00054"></a>00054 <span class="comment">#define LCD_PORT PORTA</span>
<a name="l00055"></a>00055 <span class="comment">#define LCD_DDR DDRA</span>
<a name="l00056"></a>00056 <span class="comment">#define LCD_EN_PIN PA4</span>
<a name="l00057"></a>00057 <span class="comment">#define LCD_RS_PIN PA5</span>
<a name="l00058"></a>00058 <span class="comment">// D4 -&gt; PA0, D5 -&gt; PA1, D6 -&gt; PA2, D7 -&gt; PA3</span>
<a name="l00059"></a>00059 <span class="comment">#define LCD_D4_PIN PA0</span>
<a name="l00060"></a>00060 <span class="comment">// optional:</span>
<a name="l00061"></a>00061 <span class="comment">#define LCD_RW_PIN PA6</span>
<a name="l00062"></a>00062 <span class="comment">@endcode</span>
<a name="l00063"></a>00063 <span class="comment"></span>
<a name="l00064"></a>00064 <span class="comment">\subsection shiftregister_4bit Shift Register in 4-bit-mode</span>
<a name="l00065"></a>00065 <span class="comment"></span>
<a name="l00066"></a>00066 <span class="comment">Only three IO pins are needed for shift register mode. These are connected to a shift register (74(V)HC(T)595 or similar, 8 bit, serial input, parallel output with latch).</span>
<a name="l00067"></a>00067 <span class="comment"></span>
<a name="l00068"></a>00068 <span class="comment">This mode is selected by defining LCD_MODE_SHIFT_4BIT. LCD_SHIFT_PORT, LCD_SHIFT_DDR, LCD_SHIFT_DATA_PIN, LCD_SHIFT_CLOCK_PIN, LCD_SHIFT_LATCH_PIN define the connections to the shift register. For 595-style shift registers, clock is SCK (shift clock), latch is RCK (register clock) and data is D. Set LCD_EN_PIN, LCD_RS_PIN and LCD_D4_PIN to the pin numbers at the shift register. D4, D5, D6 and D7 of the LCD are connected to output LCD_D4_PIN, LCD_D4_pin+1, and so on.</span>
<a name="l00069"></a>00069 <span class="comment"></span>
<a name="l00070"></a>00070 <span class="comment">\section display_conf Display Size Configuration</span>
<a name="l00071"></a>00071 <span class="comment"></span>
<a name="l00072"></a>00072 <span class="comment">The display size is set with LCD_COLS and LCD_LINES. For most displays, this is the real value of columns and lines.  Usually each line can be a maximum of 40 characters wide, a display may be a maximum of 4 lines high. Displays with more than two lines or non-standard displays require special configuration, which is described in the next sections.</span>
<a name="l00073"></a>00073 <span class="comment"></span>
<a name="l00074"></a>00074 <span class="comment">\subsection one_ctrl_more_lines One-Controller Displays with "half" lines</span>
<a name="l00075"></a>00075 <span class="comment"></span>
<a name="l00076"></a>00076 <span class="comment">Some displays behave as if they were twice as wide and half as high. They just display every long internal line as two lines. For such displays, use the real value for columns and lines, and define LCD_HALF_LINES. In this mode a display may be up to 8 lines high, but only up to 20 characters wide.</span>
<a name="l00077"></a>00077 <span class="comment"></span>
<a name="l00078"></a>00078 <span class="comment">The only difference between using this mode and setting double width and half height is that lcd_set_line works correctly.</span>
<a name="l00079"></a>00079 <span class="comment"></span>
<a name="l00080"></a>00080 <span class="comment">\subsection one_ctrl_four_lines Displays with special memory layout</span>
<a name="l00081"></a>00081 <span class="comment"></span>
<a name="l00082"></a>00082 <span class="comment">Some displays have a memory layout that doesn't follow the default of line 1 = 0x00, line 2 = 0x40. A different memory layout can be used by defining LCD_SPECIAL_LINE_LAYOUT and LCD_LINE1_ADDR to LCD_LINE4_ADDR. The typical layout for 4x16 character displays with only one controller is 0x00, 0x40, 0x10, 0x50. If you configured such a display as 2x32 characters (or 4x16 with LCD_HALF_LINES), the second and third line would be swapped.</span>
<a name="l00083"></a>00083 <span class="comment"></span>
<a name="l00084"></a>00084 <span class="comment">Example:</span>
<a name="l00085"></a>00085 <span class="comment">@code</span>
<a name="l00086"></a>00086 <span class="comment">#define LCD_SPECIAL_LINE_LAYOUT</span>
<a name="l00087"></a>00087 <span class="comment">#define LCD_LINE1_ADDR 0x00</span>
<a name="l00088"></a>00088 <span class="comment">#define LCD_LINE2_ADDR 0x40</span>
<a name="l00089"></a>00089 <span class="comment">#define LCD_LINE3_ADDR 0x10</span>
<a name="l00090"></a>00090 <span class="comment">#define LCD_LINE4_ADDR 0x50</span>
<a name="l00091"></a>00091 <span class="comment">@endcode</span>
<a name="l00092"></a>00092 <span class="comment"></span>
<a name="l00093"></a>00093 <span class="comment">\subsection two_ctrl_display Two-Controller Displays with four lines</span>
<a name="l00094"></a>00094 <span class="comment"></span>
<a name="l00095"></a>00095 <span class="comment">If a display has two controllers, it has two separate EN pins. You need to define the EN2 pin number with LCD_EN2_PIN. Such a display has to be configured for at least two lines. If you really have a one-line display that is more than 80 characters wide, configure it as two lines high and twice as wide.</span>
<a name="l00096"></a>00096 <span class="comment"></span>
<a name="l00097"></a>00097 <span class="comment">@code</span>
<a name="l00098"></a>00098 <span class="comment">#define LCD_TWO_CONTROLLERS</span>
<a name="l00099"></a>00099 <span class="comment">@endcode</span>
<a name="l00100"></a>00100 <span class="comment"></span>
<a name="l00101"></a>00101 <span class="comment"> */</span>
<a name="l00102"></a>00102  
<a name="l00103"></a>00103  <span class="comment"></span>
<a name="l00104"></a>00104 <span class="comment"> /** \defgroup raw_commands Raw Commands sent to the controller</span>
<a name="l00105"></a>00105 <span class="comment"> </span>
<a name="l00106"></a>00106 <span class="comment"> These constants are used when communicating directly with the controller with lcd_command(). The bit names in the description refer to the Hitachi HD44780U datasheet. Usually calling these commands from your code should not be necessary. If you use them, be careful that the LCD position should always match the internal variable lcd_position. If the position was moved, call lcd_set_position() to go to your new position, lcd_home(), go back to the old position with  @code lcd_set_position(lcd_position);@endcode, or set @code lcd_position=your_new_known_position;@endcode (faster, does not send command to the LCD)</span>
<a name="l00107"></a>00107 <span class="comment">  */</span>
<a name="l00108"></a>00108  <span class="comment"></span>
<a name="l00109"></a>00109 <span class="comment">/*@{*/</span><span class="comment"></span>
<a name="l00110"></a>00110 <span class="comment">/// Clear: clear display and go to position 0</span>
<a name="l00111"></a><a class="code" href="group__raw__commands.html#g6aa8aa2057294b7d06088e834299b369">00111</a> <span class="comment"></span><span class="preprocessor">#define LCD_CLEAR 0x01</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00113"></a>00113 <span class="comment">/// Home: go to position 0</span>
<a name="l00114"></a><a class="code" href="group__raw__commands.html#ge0e309ccad89222eb3457f2da9f2bb8d">00114</a> <span class="comment"></span><span class="preprocessor">#define LCD_HOME 0x02</span>
<a name="l00115"></a>00115 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00116"></a>00116 <span class="comment">/// &lt;b&gt;Entry Mode&lt;/b&gt;: set cursor and display movement</span>
<a name="l00117"></a><a class="code" href="group__raw__commands.html#g3147f4736f3c4bc12c5ac628f0f580ae">00117</a> <span class="comment"></span><span class="preprocessor">#define LCD_ENTRYMODE 0x04</span><span class="comment"></span>
<a name="l00118"></a>00118 <span class="comment">/// Option: I/D=1: auto-increment (left-to-right) of character position</span>
<a name="l00119"></a><a class="code" href="group__raw__commands.html#gfc92f3baa39818d346ea3790ec62db0a">00119</a> <span class="comment"></span>#define LCD_ENTRYMODE_INCREMENT 0x02<span class="comment"></span>
<a name="l00120"></a>00120 <span class="comment">/// Option: I/D=0: auto-decrement (right-to-left)</span>
<a name="l00121"></a>00121 <span class="comment">/// right-to-left is not really supported by this library yet, its internal position will not match the LCD position in this setting, it may cause trouble</span>
<a name="l00122"></a><a class="code" href="group__raw__commands.html#g83eb38062baf67806b80bdd22b47526d">00122</a> <span class="comment"></span>#define LCD_ENTRYMODE_DECREMENT 0x00
<a name="l00123"></a>00123 <span class="comment"></span>
<a name="l00124"></a>00124 <span class="comment">/// Option: S: shift: the cursor does not move, but the display does</span>
<a name="l00125"></a>00125 <span class="comment">/// This is currently unsupported, automatic linebreak may do wrong things</span>
<a name="l00126"></a>00126 <span class="comment">/// The shifting does not work across line borders</span>
<a name="l00127"></a><a class="code" href="group__raw__commands.html#gc976ee79219acb41cd216a5d8576c48b">00127</a> <span class="comment"></span><span class="preprocessor">#define LCD_ENTRYMODE_SHIFT 0x01</span>
<a name="l00128"></a>00128 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00129"></a>00129 <span class="comment">/// &lt;b&gt;Display On/Off Control&lt;/b&gt; - used by lcd_set_cursor()</span>
<a name="l00130"></a><a class="code" href="group__raw__commands.html#gcab2b60f7dac0a43694b105a013c5039">00130</a> <span class="comment"></span><span class="preprocessor">#define LCD_CONTROL 0x08</span><span class="comment"></span>
<a name="l00131"></a>00131 <span class="comment">/// Option: D=1: display on</span>
<a name="l00132"></a><a class="code" href="group__raw__commands.html#g2080ed465c6450427feebc6e380abdb3">00132</a> <span class="comment"></span>#define LCD_CONTROL_DISPLAY_ON 0x04<span class="comment"></span>
<a name="l00133"></a>00133 <span class="comment">/// Option: D=0: display off (clear)</span>
<a name="l00134"></a><a class="code" href="group__raw__commands.html#g5cc3719093a308b139aad8d2dd544240">00134</a> <span class="comment"></span>#define LCD_CONTROL_DISPLAY_OFF 0x00<span class="comment"></span>
<a name="l00135"></a>00135 <span class="comment">/// Option: C=1: display cursor</span>
<a name="l00136"></a><a class="code" href="group__raw__commands.html#g833d1a705bac2ee9d61e4cf8223563ce">00136</a> <span class="comment"></span>#define LCD_CONTROL_CURSOR_ON 0x02<span class="comment"></span>
<a name="l00137"></a>00137 <span class="comment">/// Option: C=0: no cursor</span>
<a name="l00138"></a><a class="code" href="group__raw__commands.html#g38f1e08dc5c09633d0bb2c07164d57b3">00138</a> <span class="comment"></span>#define LCD_CONTROL_CURSOR_OFF 0x00<span class="comment"></span>
<a name="l00139"></a>00139 <span class="comment">/// Option: B=1: blink current character</span>
<a name="l00140"></a><a class="code" href="group__raw__commands.html#g5acada1d15638cb18c97e3accc64f097">00140</a> <span class="comment"></span>#define LCD_CONTROL_BLINK 0x01
<a name="l00141"></a>00141 <span class="comment"></span>
<a name="l00142"></a>00142 <span class="comment">/// &lt;b&gt;Cursor (or Display) shift&lt;/b&gt;: move cursor or display content - please call lcd_set_position() after moving the cursor with this command, not really supported</span>
<a name="l00143"></a><a class="code" href="group__raw__commands.html#g921b50a756949abc5a25094b0c191a10">00143</a> <span class="comment"></span><span class="preprocessor">#define LCD_SHIFT 0x10</span><span class="comment"></span>
<a name="l00144"></a>00144 <span class="comment">/// Option: S/C=1: move cursor position</span>
<a name="l00145"></a><a class="code" href="group__raw__commands.html#ge8ef8c05d43d77d16e131eb718ae4ac7">00145</a> <span class="comment"></span>#define LCD_SHIFT_DISPLAY 0x08<span class="comment"></span>
<a name="l00146"></a>00146 <span class="comment">/// Option: S/C=0: move display content, cursor stays at the same position (not really supported)</span>
<a name="l00147"></a><a class="code" href="group__raw__commands.html#g7bd7034ad5f552265a6baefeb79f9c5b">00147</a> <span class="comment"></span>#define LCD_SHIFT_CURSOR 0x00<span class="comment"></span>
<a name="l00148"></a>00148 <span class="comment">/// Option: R/L=1: right</span>
<a name="l00149"></a><a class="code" href="group__raw__commands.html#g8ab3108396a0d33dbf7f3ab6477ba01d">00149</a> <span class="comment"></span>#define LCD_SHIFT_RIGHT 0x04<span class="comment"></span>
<a name="l00150"></a>00150 <span class="comment">/// Option: R/L=0: left</span>
<a name="l00151"></a><a class="code" href="group__raw__commands.html#g941377571f34b9d898b61ce89f10226d">00151</a> <span class="comment"></span>#define LCD_SHIFT_LEFT 0x00
<a name="l00152"></a>00152 <span class="comment"></span>
<a name="l00153"></a>00153 <span class="comment">/// &lt;b&gt;Function Set&lt;/b&gt;: Initialize the Controllers - used by lcd_init()</span>
<a name="l00154"></a><a class="code" href="group__raw__commands.html#g50de1697f1da8ab075a6b4d7aeace64e">00154</a> <span class="comment"></span><span class="preprocessor">#define LCD_FUNCTION 0x20</span><span class="comment"></span>
<a name="l00155"></a>00155 <span class="comment">/// Option: DL=1: interface data length 8bit</span>
<a name="l00156"></a><a class="code" href="group__raw__commands.html#g91d15d8e3008f6cb141406a8b5d0d3c0">00156</a> <span class="comment"></span>#define LCD_FUNCTION_8BIT 0x10<span class="comment"></span>
<a name="l00157"></a>00157 <span class="comment">/// Option: DL=0: interface data length 4bit</span>
<a name="l00158"></a><a class="code" href="group__raw__commands.html#g88267db52f73473e317ac0da8294239f">00158</a> <span class="comment"></span>#define LCD_FUNCTION_4BIT 0x00<span class="comment"></span>
<a name="l00159"></a>00159 <span class="comment">/// Option: N=1: two display lines (per controller)</span>
<a name="l00160"></a><a class="code" href="group__raw__commands.html#g6c24806bed18d565917165caa3475463">00160</a> <span class="comment"></span>#define LCD_FUNCTION_2LINES 0x08<span class="comment"></span>
<a name="l00161"></a>00161 <span class="comment">/// Option: N=0: one display line (per controller)</span>
<a name="l00162"></a><a class="code" href="group__raw__commands.html#gcae6bef7acd5c61dcfe7f76790023bad">00162</a> <span class="comment"></span>#define LCD_FUNCTION_1LINE 0x00<span class="comment"></span>
<a name="l00163"></a>00163 <span class="comment">/// Option: F=1: character font</span>
<a name="l00164"></a><a class="code" href="group__raw__commands.html#g528cbca19acdb596f0cf1b780e564152">00164</a> <span class="comment"></span>#define LCD_FUNCTION_5x10 0x04<span class="comment"></span>
<a name="l00165"></a>00165 <span class="comment">/// Option: F=0: character font</span>
<a name="l00166"></a><a class="code" href="group__raw__commands.html#gfbd0c91019fe97848ef21dfe4e12c08a">00166</a> <span class="comment"></span>#define LCD_FUNCTION_5x8 0x00
<a name="l00167"></a>00167 <span class="comment"></span>
<a name="l00168"></a>00168 <span class="comment">/// &lt;b&gt;Set Character Generator RAM Address&lt;/b&gt;</span>
<a name="l00169"></a><a class="code" href="group__raw__commands.html#gbb237a65fd1053415cb67ba994ae5d6c">00169</a> <span class="comment"></span><span class="preprocessor">#define LCD_SET_CGRAM_ADDR 0x40</span>
<a name="l00170"></a>00170 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00171"></a>00171 <span class="comment">/// &lt;b&gt;Set Display Data RAM Address&lt;/b&gt; (LCD Position) - used by lcd_set_position(), lcd_set_line()</span>
<a name="l00172"></a><a class="code" href="group__raw__commands.html#ge5fd52eb2dc8c41214d4872644e8f0aa">00172</a> <span class="comment"></span><span class="preprocessor">#define LCD_SET_DDRAM_ADDR 0x80</span>
<a name="l00173"></a>00173 <span class="preprocessor"></span><span class="comment"> /*@}*/</span>
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="preprocessor">#define LCD_ALL_CONTROLLERS 255</span>
<a name="l00178"></a>00178 <span class="preprocessor"></span>
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 <span class="preprocessor">#if defined(LCD_MODE_4BIT) &amp;&amp; ( !defined(LCD_PORT) || !defined(LCD_DDR) || !defined(LCD_EN_PIN) || !defined(LCD_RS_PIN) || !defined(LCD_D4_PIN) || !defined(LCD_LINES) || !defined(LCD_COLS))</span>
<a name="l00181"></a>00181 <span class="preprocessor"></span><span class="preprocessor">#error for LCD_MODE_4BIT the constants LCD_PORT, LCD_DDR, LCD_EN_PIN, LCD_RS_PIN, LCD_D4_PIN, LCD_LINES, LCD_COLS need to be defined</span>
<a name="l00182"></a>00182 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00183"></a>00183 <span class="preprocessor"></span>
<a name="l00184"></a>00184 <span class="preprocessor">#if defined(LCD_MODE_SHIFT_4BIT) &amp;&amp; ( !defined(LCD_SHIFT_PORT) || !defined(LCD_SHIFT_DDR) || !defined(LCD_SHIFT_DATA_PIN) || !defined(LCD_SHIFT_CLOCK_PIN) || !defined(LCD_SHIFT_LATCH_PIN) || !defined(LCD_EN_PIN) || !defined(LCD_RS_PIN) || !defined(LCD_D4_PIN) || !defined(LCD_LINES) || !defined(LCD_COLS))</span>
<a name="l00185"></a>00185 <span class="preprocessor"></span><span class="preprocessor">#error for LCD_MODE_4BIT the constants LCD_SHIFT_PORT, LCD_SHIFT_DDR, LCD_SHIFT_DATA_PIN, LCD_SHIFT_CLOCK_PIN, LCD_SHIFT_LATCH_PIN, LCD_EN_PIN, LCD_RS_PIN, LCD_D4_PIN, LCD_LINES, LCD_COLS need to be defined</span>
<a name="l00186"></a>00186 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00187"></a>00187 <span class="preprocessor"></span>
<a name="l00188"></a>00188 <span class="preprocessor">#if !defined(LCD_MODE_4BIT) &amp;&amp; !defined(LCD_MODE_8BIT) &amp;&amp; !defined(LCD_MODE_SHIFT_4BIT)</span>
<a name="l00189"></a>00189 <span class="preprocessor"></span><span class="preprocessor">#error please define LCD interface mode (currently only LCD_MODE_4BIT and LCD_MODE_SHIFT_4BIT is supported)</span>
<a name="l00190"></a>00190 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00191"></a>00191 <span class="preprocessor"></span><span class="comment">// TODO: planned: 8bit, 8bit with two shift registers soft-spi (3 pins)</span>
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="preprocessor">#if (LCD_LINES&gt;2) &amp;&amp; !defined(LCD_TWO_CONTROLLERS) &amp;&amp; !defined(LCD_SPECIAL_LINE_LAYOUT)</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span><span class="preprocessor">#error LCDs with more than two lines usually need two controllers. If there is a second LCD_EN pin, define LCD_TWO_CONTROLLERS and LCD_EN2_PIN. If there is no second LCD_EN_PIN, try using double LCD_COLS and half LCD_LINES. Otherwise, try defining a memory layout with LCD_SPECIAL_LINE_LAYOUT. (see documentation)</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00197"></a>00197 <span class="preprocessor"></span>
<a name="l00198"></a>00198 <span class="preprocessor">#if defined(LCD_SPECIAL_LINE_LAYOUT) &amp;&amp; ( !defined(LCD_LINE1_ADDR) || !defined(LCD_LINE2_ADDR) || !defined(LCD_LINE3_ADDR) || !defined(LCD_LINE4_ADDR) )</span>
<a name="l00199"></a>00199 <span class="preprocessor"></span><span class="preprocessor">#error For LCD_SPECIAL_LINE_LAYOUT you need to define LCD_LINE1_ADDR, LCD_LINE2_ADDR, LCD_LINE3_ADDR and LCD_LINE4_ADDR. If you have less than four lines, simply define the unneeded constans as 0.</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00201"></a>00201 <span class="preprocessor"></span>
<a name="l00202"></a>00202 <span class="preprocessor">#if defined(LCD_SPECIAL_LINE_LAYOUT) &amp;&amp; ( (!defined(LCD_HALF_LINES) &amp;&amp; (LCD_LINES&gt;4)) || (defined(LCD_HALF_LINES) &amp;&amp; (LCD_LINES&gt;8)))</span>
<a name="l00203"></a>00203 <span class="preprocessor"></span><span class="preprocessor">#error LCD_SPECIAL_LINE_LAYOUT only works for up to 4 lines (or up to 8 "half" lines with LCD_HALF_LINES)</span>
<a name="l00204"></a>00204 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00205"></a>00205 <span class="preprocessor"></span>
<a name="l00206"></a>00206 <span class="preprocessor">#if (LCD_LINES*LCD_COLS&gt;80) &amp;&amp; !defined(LCD_TWO_CONTROLLERS)</span>
<a name="l00207"></a>00207 <span class="preprocessor"></span><span class="preprocessor">#error There can be maximum 80 characters per controller, you should define LCD_TWO_CONTROLLERS and LCD_EN2_PIN.</span>
<a name="l00208"></a>00208 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00209"></a>00209 <span class="preprocessor"></span>
<a name="l00210"></a>00210 <span class="preprocessor">#if defined(LCD_TWO_CONTROLLERS) &amp;&amp; !defined(LCD_EN2_PIN)</span>
<a name="l00211"></a>00211 <span class="preprocessor"></span><span class="preprocessor">#error For LCD_TWO_CONTROLLERS you need LCD_EN2_PIN</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span>
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 <span class="preprocessor">#if defined(LCD_MODE_4BIT) || defined(LCD_MODE_8BIT)</span>
<a name="l00216"></a>00216 <span class="preprocessor"></span><span class="preprocessor">#define LCD_OUT LCD_PORT</span>
<a name="l00217"></a>00217 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00218"></a>00218 <span class="preprocessor"></span><span class="comment">// buffer for shift-register output</span>
<a name="l00219"></a>00219 uint8_t lcd_out_buf=0;
<a name="l00220"></a>00220 <span class="preprocessor">#define LCD_OUT lcd_out_buf</span>
<a name="l00221"></a>00221 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span>
<a name="l00223"></a>00223 <span class="comment">// Prototypes created with cat lcd.c | sed -n "s/^\([a-z].*(.*)\)[ \\t]*[\{][^;]*\$/\1;/p"</span>
<a name="l00224"></a>00224 <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__lowlevelio.html#g63c111d5d564f440682022cdb282b3d4" title="Set data outputs.">LCD_DATA_OUT</a>(uint8_t data);
<a name="l00225"></a>00225 <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__lowlevelio.html#g1d2230b21228a75f1271dc07e04e8be4" title="Set the RS output pin.">LCD_RS</a>(uint8_t rs);
<a name="l00226"></a>00226 <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__lowlevelio.html#g6e2fe0dcc61696fe48f7ab8b58ba037e" title="Set the EN output pin.">LCD_EN</a>(uint8_t en);
<a name="l00227"></a>00227 <span class="keywordtype">void</span> <a class="code" href="group__lowlevelio.html#g9296a4318c8dc4baf83afd81fd357feb" title="Update output port from buffer.">LCD_OUT_UPDATE</a>(<span class="keywordtype">void</span>);
<a name="l00228"></a>00228 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g577127e048d083cb55aa602cbc5a1cfe" title="Send a raw command and wait for the execution time (3ms for home and clear, 100µs...">lcd_command</a>(uint8_t data);
<a name="l00229"></a>00229 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#gd0729d2cba627825a089ca1fff12ba29" title="Send data and wait 50µs.">lcd_data</a>(uint8_t data);
<a name="l00230"></a>00230 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g932614e4a3dde92103df18b6868da624" title="Write data or commands to the LCD.">lcd_write</a>(uint8_t data, uint8_t rs);
<a name="l00231"></a>00231 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#ga5ed1c9a2a2fde3f98b02102c889dab9" title="Write a half-byte in 4-bit-mode to the LCD.">lcd_nibble</a>(uint8_t data);
<a name="l00232"></a>00232 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g6842775ba83d166f02b8fef8bb63b1e6" title="Initialise the LCD.">lcd_init</a>(<span class="keywordtype">void</span>);
<a name="l00233"></a>00233 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g3aabf730aa4e0393bb5c959583c00a8e" title="Go to the start position (takes 3ms to execute) This also resets some shift-options...">lcd_home</a>(<span class="keywordtype">void</span>);
<a name="l00234"></a>00234 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g615cf8980680849dce3c379d30e30ec6" title="(internal function) Select the controller">lcd_set_controller</a>(uint8_t num);
<a name="l00235"></a>00235 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#gd235a86241458b1e7b8771688bfdaf9a" title="Clear the LCD (takes 3ms to execute) and go back to the start position For two-controller...">lcd_clear</a>(<span class="keywordtype">void</span>);
<a name="l00236"></a>00236 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g25866d401362c56e699caec5336252dc" title="Go to the start of the specified line.">lcd_set_line</a>(uint8_t x);
<a name="l00237"></a>00237 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g2f118878f15d5d64fade1bbc193be2fc" title="Go to the specified position.">lcd_set_position</a>(uint8_t position);
<a name="l00238"></a>00238 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g9a4f2e437d82747664790aed0f1e4b69" title="Set the cursor mode, switches the LCD on or off.">lcd_set_cursor</a>(uint8_t mode);
<a name="l00239"></a>00239 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g52872b8bc9e8fc6988edb1dad61a33a2" title="(internal function) If the cursor has passed the end of a line, set the position...">lcd_linewrap</a>(<span class="keywordtype">void</span>);
<a name="l00240"></a>00240 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#gb55f2679b2a60dd5ff9795feddffb4ba" title="Write a single char to the LCD at the current position.">lcd_putchar</a>(<span class="keywordtype">char</span> chr);
<a name="l00241"></a>00241 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g441efb2945fb74fafb7914d6bd2d8161" title="Write a string starting at the current position.">lcd_putstr</a>(<span class="keywordtype">char</span> *str);
<a name="l00242"></a>00242 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#gd3226e2e167c11093fa3641e5f33f732" title="Write a string from ROM starting at the current position.">lcd_putstr_P</a>(PGM_P str);
<a name="l00243"></a>00243 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g8531c55ba576c0b39c0d72bd6617c91f" title="Write a string after clearing the display.">lcd_print</a>(<span class="keywordtype">char</span> *str);
<a name="l00244"></a>00244 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#g70ff998a1fbdc2f2c8857b5fd7407436" title="Add a custom character.">lcd_customchar</a>(uint8_t number, uint8_t *data);
<a name="l00245"></a>00245 <span class="keywordtype">void</span> <a class="code" href="group__lcd__functions.html#ga359b210285538e2fb99c2066586f3c8" title="Add a custom character from ROM This is like lcd_customchar(), but the character...">lcd_customchar_P</a>(uint8_t number, PGM_P data);
<a name="l00246"></a>00246 <span class="preprocessor">#endif // _LCD_H_INCLUDED</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat Nov 6 17:15:22 2010 for HD44780 Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
